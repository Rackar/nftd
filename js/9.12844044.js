(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"5a6b":function(e,t,n){"use strict";n("bad1")},"652d":function(e,t,n){"use strict";n.r(t);n("e01a");var a=n("7a23");const o=Object(a["m"])("h1",{class:"row myh1"},"test NFT publish",-1),l=Object(a["m"])("div",{class:"row"},null,-1),i={class:"q-pa-md",style:{"max-width":"500px","min-width":"400px"}},r={key:0},c=Object(a["l"])(" Approved NFT id: "),s={style:{color:"red"}};function d(e,t,n,d,u,m){const b=Object(a["J"])("q-input"),p=Object(a["J"])("q-spinner"),f=Object(a["J"])("q-inner-loading"),O=Object(a["J"])("q-btn"),j=Object(a["J"])("q-form"),g=Object(a["J"])("q-page");return Object(a["D"])(),Object(a["i"])(g,{class:"column items-center"},{default:Object(a["Q"])((()=>[o,l,Object(a["m"])("div",i,[Object(a["m"])(j,{onSubmit:d.onSubmit,class:"q-gutter-md"},{default:Object(a["Q"])((()=>[Object(a["m"])(b,{outlined:"",modelValue:d.current.name,"onUpdate:modelValue":t[1]||(t[1]=e=>d.current.name=e),label:"NFT Name"},null,8,["modelValue"]),Object(a["m"])(b,{outlined:"",type:"textarea",modelValue:d.current.description,"onUpdate:modelValue":t[2]||(t[2]=e=>d.current.description=e),label:"NFT description"},null,8,["modelValue"]),Object(a["m"])(b,{outlined:"",modelValue:d.current.image,"onUpdate:modelValue":t[3]||(t[3]=e=>d.current.image=e),label:"NFT image path",rules:[e=>e&&"http"===e.substr(0,4)||"Image path start with http/https"]},null,8,["modelValue","rules"]),Object(a["m"])(b,{outlined:"",modelValue:d.current.artistName,"onUpdate:modelValue":t[4]||(t[4]=e=>d.current.artistName=e),label:"Artist Name"},null,8,["modelValue"]),Object(a["m"])(b,{outlined:"",modelValue:d.current.artistInfo,"onUpdate:modelValue":t[5]||(t[5]=e=>d.current.artistInfo=e),label:"Artist Information"},null,8,["modelValue"]),Object(a["m"])("div",null,[Object(a["m"])(O,{label:"publish",type:"submit",color:"primary"},{default:Object(a["Q"])((()=>[Object(a["m"])(f,{showing:d.current.loading},{default:Object(a["Q"])((()=>[Object(a["m"])(p,{color:"primary",size:"3em",thickness:2})])),_:1},8,["showing"])])),_:1})]),d.current.nftid?(Object(a["D"])(),Object(a["i"])("div",r,[c,Object(a["m"])("span",s,Object(a["L"])(d.current.nftid),1)])):Object(a["j"])("",!0)])),_:1},8,["onSubmit"])])])),_:1})}n("e6cf");var u=n("b3fe"),m=n("5502"),b=n("e37a"),p=n("a748");const f=n("99e5");var O={name:"CreateNFT",setup(){const e=Object(u["a"])(),t=Object(m["b"])(),n=Object(a["F"])({name:"",description:"",image:"",artistName:"",loading:!1,nftid:Object(a["g"])({get:()=>t.state.example.nftIdApproved,set:e=>{t.commit("example/setNftIdApproved",e)}})});function o(){const e=new f(window.ethereum),t=new e.eth.Contract(b["b"],b["d"]);return t}async function l(){let t=o(),a=await Object(b["e"])();return new Promise((async(o,l)=>{n.loading=!0;let r=await t.methods.totalSupply().call();r=parseInt(r)+1,t.methods.awardItem(a,p["base"]+"nfts?id="+r).send({from:a}).then((async function(l){let c=l.events.Transfer.returnValues;if(c.tokenId!=r)return void console.log("NFT入库tokenURI id矛盾");let s={name:n.name,description:n.description,image:n.image,artistName:n.artistName,artistInfo:n.artistInfo,nftid:r,contractAd:b["d"]};n.nftid=r,console.log("NFT status: "+JSON.stringify(l)),e.notify("Creating successes. Now approving.");let d=await p["api"].post("nfts",{nft:s});d&&(console.log(d),i(t,b["c"],r,a));o(l)})).catch((e=>{console.log(e),n.loading=!1}))}))}function i(t,a,o,l){return new Promise(((i,r)=>{console.log(n),t.methods.approve(a,o).send({from:l}).then((function(t){console.log("approve: "+JSON.stringify(t)),e.notify("New NFT id is "+o+", please copy it to sell."),n.loading=!1;i(t)})).catch((e=>{console.log(e),n.loading=!1}))}))}return{current:n,onSubmit:l}}},j=(n("5a6b"),n("9989")),g=n("0378"),h=n("27f9"),w=n("9564"),N=n("9c40"),y=n("74f7"),V=n("0d59"),v=n("eebe"),I=n.n(v);O.render=d;t["default"]=O;I()(O,"components",{QPage:j["a"],QForm:g["a"],QInput:h["a"],QToggle:w["a"],QBtn:N["a"],QInnerLoading:y["a"],QSpinner:V["a"]})},bad1:function(e,t,n){}}]);